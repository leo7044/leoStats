/* Developer: leo7044 (https://github.com/leo7044) */
!function(){function e(){!function e(){try{if("undefined"!=typeof qx&&qx.core.Init.getApplication().getMenuBar())return ke="https://cnc.indyserver.info/",ge="2022.03.13",qx.Class.define("leoStats",{type:"singleton",extend:qx.core.Object,construct:function(){console.log("create leoStats...")},members:{initialize:function(){this.sendChatInfoStatus=!0,this.ObjectData={},this.ObjectDataNotSend={},this.linkBase="",this.ObjectReportData={},this.timeoutArrayReportDataManager=[],this.ReportsAreLoading=!1,this.app=qx.core.Init.getApplication(),this.GuiButtonLeoStats=new qx.ui.form.Button("leoStats").set({center:!0,rich:!0}),this.setCncOptVars(),this.getCurrentStats(),this.buildGUI()},buildGUI:function(){this.GuiFenster=new qx.ui.window.Window("leoStats "+ge+" by leo7044").set({padding:5,paddingRight:0,width:350,showMaximize:!1,showMinimize:!1,showClose:!0,allowClose:!0,resizable:!1}),this.GuiFenster.setTextColor("black"),this.GuiFenster.setLayout(new qx.ui.layout.HBox),this.GuiFenster.moveTo(200,48),this.GuiTab=(new qx.ui.tabview.TabView).set({contentPaddingTop:3,contentPaddingBottom:6,contentPaddingRight:7,contentPaddingLeft:3}),this.GuiFenster.add(this.GuiTab),this.GuiInfoPage=new qx.ui.tabview.Page("Info"),this.GuiInfoPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiInfoPage),this.GuiInfoVBox=new qx.ui.container.Composite,this.GuiInfoVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiInfoVBox.setThemedPadding(10),this.GuiInfoVBox.setThemedBackgroundColor("#eef"),this.GuiInfoPage.add(this.GuiInfoVBox),this.GuiBasesPage=new qx.ui.tabview.Page("Bases"),this.GuiBasesPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiBasesPage),this.GuiBasesVBox=new qx.ui.container.Composite,this.GuiBasesVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiBasesVBox.setThemedPadding(10),this.GuiBasesVBox.setThemedBackgroundColor("#eef"),this.GuiBasesPage.add(this.GuiBasesVBox),this.GuiPlayerPage=new qx.ui.tabview.Page("Player"),this.GuiPlayerPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiPlayerPage),this.GuiPlayerVBox=new qx.ui.container.Composite,this.GuiPlayerVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiPlayerVBox.setThemedPadding(10),this.GuiPlayerVBox.setThemedBackgroundColor("#eef"),this.GuiPlayerPage.add(this.GuiPlayerVBox),this.GuiAlliancePage=new qx.ui.tabview.Page("Alliance"),this.GuiAlliancePage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiAlliancePage),this.GuiAllianceVBox=new qx.ui.container.Composite,this.GuiAllianceVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiAllianceVBox.setThemedPadding(10),this.GuiAllianceVBox.setThemedBackgroundColor("#eef"),this.GuiAlliancePage.add(this.GuiAllianceVBox),this.GuiPoisPage=new qx.ui.tabview.Page("POIs"),this.GuiPoisPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiPoisPage),this.GuiPoisVBox=new qx.ui.container.Composite,this.GuiPoisVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiPoisVBox.setThemedPadding(10),this.GuiPoisVBox.setThemedBackgroundColor("#eef"),this.GuiPoisPage.add(this.GuiPoisVBox),this.GuiPoiDataPage=new qx.ui.tabview.Page("POI-Data"),this.GuiPoiDataPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiPoiDataPage),this.GuiPoiDataVBox=new qx.ui.container.Composite,this.GuiPoiDataVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiPoiDataVBox.setThemedPadding(10),this.GuiPoiDataVBox.setThemedBackgroundColor("#eef"),this.GuiPoiDataPage.add(this.GuiPoiDataVBox),this.GuiResourcesPage=new qx.ui.tabview.Page("Resources"),this.GuiResourcesPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiResourcesPage),this.GuiResourcesVBox=new qx.ui.container.Composite,this.GuiResourcesVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiResourcesVBox.setThemedPadding(10),this.GuiResourcesVBox.setThemedBackgroundColor("#eef"),this.GuiResourcesPage.add(this.GuiResourcesVBox),this.GuiSellBasesPage=new qx.ui.tabview.Page("Sell bases"),this.GuiSellBasesPage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiSellBasesPage),this.GuiSellBasesVBox=new qx.ui.container.Composite,this.GuiSellBasesVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiSellBasesVBox.setThemedPadding(10),this.GuiSellBasesVBox.setThemedBackgroundColor("#eef"),this.GuiSellBasesPage.add(this.GuiSellBasesVBox),this.GuiSellSpecialBasePage=new qx.ui.tabview.Page("Sell special base"),this.GuiSellSpecialBasePage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiSellSpecialBasePage),this.GuiSellSpecialBaseVBox=new qx.ui.container.Composite,this.GuiSellSpecialBaseVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiSellSpecialBaseVBox.setThemedPadding(10),this.GuiSellSpecialBaseVBox.setThemedBackgroundColor("#eef"),this.GuiSellSpecialBasePage.add(this.GuiSellSpecialBaseVBox),this.GuiUpgradeSpecialBasePage=new qx.ui.tabview.Page("Upgrade special base"),this.GuiUpgradeSpecialBasePage.setLayout(new qx.ui.layout.Grow),this.GuiTab.add(this.GuiUpgradeSpecialBasePage),this.GuiUpgradeSpecialBaseVBox=new qx.ui.container.Composite,this.GuiUpgradeSpecialBaseVBox.setLayout(new qx.ui.layout.VBox(5)),this.GuiUpgradeSpecialBaseVBox.setThemedPadding(10),this.GuiUpgradeSpecialBaseVBox.setThemedBackgroundColor("#eef"),this.GuiUpgradeSpecialBasePage.add(this.GuiUpgradeSpecialBaseVBox),this.GuiButtonLeoStats.addListener("click",function(){this.GuiInfoVBox.removeAll(),this.GuiBasesVBox.removeAll(),this.GuiPlayerVBox.removeAll(),this.GuiAllianceVBox.removeAll(),this.GuiPoisVBox.removeAll(),this.GuiPoiDataVBox.removeAll(),this.GuiResourcesVBox.removeAll(),this.GuiSellBasesVBox.removeAll(),this.GuiSellSpecialBaseVBox.removeAll(),this.GuiUpgradeSpecialBaseVBox.removeAll(),this.getCurrentStats(),this.showGui(),this.GuiFenster.show()},this),this.app.getDesktop().add(this.GuiButtonLeoStats,{right:125,top:0})},showGui:function(){var e=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),t=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));t.add(new qx.ui.basic.Label("<big><u><b>Information</b></u></big>").set({rich:!0})),t.add(new qx.ui.basic.Label("").set({rich:!0}));var a=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),i=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"right"})),n=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"left"}));i.add(new qx.ui.basic.Label("<b>Scriptname</b>").set({rich:!0})),n.add(new qx.ui.basic.Label("leoStats").set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Version</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(ge).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Autor</b>").set({rich:!0})),n.add(new qx.ui.basic.Label("leo7044").set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Website</b>").set({rich:!0})),n.add(new qx.ui.basic.Label('<a href="'+ke+'" target="_blank">'+ke+"</a>").set({rich:!0})),i.add(new qx.ui.basic.Label("<b>BaseScanner</b>").set({rich:!0})),n.add(new qx.ui.basic.Label('<a href="'+ke+"BaseScanner/?WorldId="+this.ObjectData.server.WorldId+'" target="_blank">'+ke+"BaseScanner/?WorldId="+this.ObjectData.server.WorldId+"</a>").set({rich:!0})),i.add(new qx.ui.basic.Label("<b>E-Mail</b>").set({rich:!0})),n.add(new qx.ui.basic.Label('<a href="mailto:cc.ta.leo7044@gmail.com">cc.ta.leo7044@gmail.com</a>').set({rich:!0})),a.add(i),a.add(n),t.add(a);var s=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));s.add(new qx.ui.basic.Label("").set({rich:!0})),s.add(new qx.ui.basic.Label('<form><input type="button" value="Transmit data" onclick="leoStats.getInstance().getCurrentStats();"/></form>').set({rich:!0})),t.add(s),e.add(t),this.GuiInfoVBox.add(e);var r=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),o=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));o.add(new qx.ui.basic.Label("<big><u><b>Playerbases</b></u></big>").set({rich:!0})),o.add(new qx.ui.basic.Label("").set({rich:!0}));var l=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),c=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),u=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),d=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),b=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),g=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),h=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),x=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),D=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),w=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),p=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),L=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));for(A in c.add(new qx.ui.basic.Label("<b>BaseName</b>").set({rich:!0})),d.add(new qx.ui.basic.Label("<b>CY</b>").set({rich:!0})),b.add(new qx.ui.basic.Label("<b>Base</b>").set({rich:!0})),g.add(new qx.ui.basic.Label("<b>Off</b>").set({rich:!0})),h.add(new qx.ui.basic.Label("<b>Def</b>").set({rich:!0})),x.add(new qx.ui.basic.Label("<b>DF</b>").set({rich:!0})),D.add(new qx.ui.basic.Label("<b>Sup</b>").set({rich:!0})),u.add(new qx.ui.basic.Label("<b>Tiberium</b>").set({rich:!0})),w.add(new qx.ui.basic.Label("<b>Crystal</b>").set({rich:!0})),p.add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0})),L.add(new qx.ui.basic.Label("<b>Credits</b>").set({rich:!0})),this.ObjectData.bases)c.add(new qx.ui.basic.Label(this.ObjectData.bases[A].BaseName).set({rich:!0,alignX:"left"})),d.add(new qx.ui.basic.Label(this.ObjectData.bases[A].LvLCY.toLocaleString()).set({rich:!0,alignX:"right"})),b.add(new qx.ui.basic.Label(this.ObjectData.bases[A].LvLBase.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),g.add(new qx.ui.basic.Label(this.ObjectData.bases[A].LvLOffense.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),h.add(new qx.ui.basic.Label(this.ObjectData.bases[A].LvLDefense.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),x.add(new qx.ui.basic.Label(this.ObjectData.bases[A].LvLDF.toLocaleString()).set({rich:!0,alignX:"right"})),0<this.ObjectData.bases[A].LvLSupport?D.add(new qx.ui.basic.Label(this.ObjectData.bases[A].LvLSupport.toLocaleString()+" ("+this.ObjectData.bases[A].SupArt+")").set({rich:!0,alignX:"right"})):D.add(new qx.ui.basic.Label("---").set({rich:!0,alignX:"right"})),u.add(new qx.ui.basic.Label(this.ObjectData.bases[A].TiberiumPerHour.toLocaleString()).set({rich:!0,alignX:"right"})),w.add(new qx.ui.basic.Label(this.ObjectData.bases[A].CrystalPerHour.toLocaleString()).set({rich:!0,alignX:"right"})),p.add(new qx.ui.basic.Label(this.ObjectData.bases[A].PowerPerHour.toLocaleString()).set({rich:!0,alignX:"right"})),L.add(new qx.ui.basic.Label(this.ObjectData.bases[A].CreditsPerHour.toLocaleString()).set({rich:!0,alignX:"right"}));c.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0})),d.add(new qx.ui.basic.Label(this.ObjectData.player.AverageCY.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),b.add(new qx.ui.basic.Label(this.ObjectData.player.AverageBase.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),g.add(new qx.ui.basic.Label(this.ObjectData.player.AverageOff.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),h.add(new qx.ui.basic.Label(this.ObjectData.player.AverageDef.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),x.add(new qx.ui.basic.Label(this.ObjectData.player.AverageDF.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),D.add(new qx.ui.basic.Label(this.ObjectData.player.AverageSup.toFixed(2).toLocaleString()).set({rich:!0,alignX:"right"})),u.add(new qx.ui.basic.Label(this.ObjectData.player.ProductionTiberium.toLocaleString()).set({rich:!0,alignX:"right"})),w.add(new qx.ui.basic.Label(this.ObjectData.player.ProductionCrystal.toLocaleString()).set({rich:!0,alignX:"right"})),p.add(new qx.ui.basic.Label(this.ObjectData.player.ProductionPower.toLocaleString()).set({rich:!0,alignX:"right"})),L.add(new qx.ui.basic.Label(this.ObjectData.player.ProductionCredits.toLocaleString()).set({rich:!0,alignX:"right"})),l.add(c),l.add(d),l.add(b),l.add(g),l.add(h),l.add(x),l.add(D),l.add(u),l.add(w),l.add(p),l.add(L),o.add(l),r.add(o),this.GuiBasesVBox.add(r),this.createTabPlayer(),this.createTabAlliance();var C=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),_=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));_.add(new qx.ui.basic.Label("<big><u><b>POIs</b></u></big>").set({rich:!0})),_.add(new qx.ui.basic.Label("").set({rich:!0}));var i=(new qx.ui.container.Scroll).set({width:627,height:560}),n=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),q=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),y=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),f=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),m=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),B=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),I=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),O=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),a=null,s=null,t=null,e=null,l=null,o=null,r=null;q.add(a=new qx.ui.basic.Atom("<b>Tiberium</b>","webfrontend/ui/common/icn_res_tiberium.png").set({rich:!0})),a.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),y.add(s=new qx.ui.basic.Atom("<b>Crystal</b>","webfrontend/ui/common/icn_res_chrystal.png").set({rich:!0})),s.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),f.add(t=new qx.ui.basic.Atom("<b>Power</b>","webfrontend/ui/common/icn_res_power.png").set({rich:!0})),t.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),m.add(e=new qx.ui.basic.Atom("<b>Infantry</b>","FactionUI/icons/icon_arsnl_off_squad.png").set({rich:!0})),e.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),B.add(l=new qx.ui.basic.Atom("<b>Vehicle</b>","FactionUI/icons/icon_arsnl_off_vehicle.png").set({rich:!0})),l.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),I.add(o=new qx.ui.basic.Atom("<b>Aircraft</b>","FactionUI/icons/icon_arsnl_off_plane.png").set({rich:!0})),o.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),O.add(r=new qx.ui.basic.Atom("<b>Defense</b>","FactionUI/icons/icon_def_army_points.png").set({rich:!0})),r.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"});var G=[];for(A in this.ObjectData.alliance.AllianceId&&(G=ClientLib.Data.MainData.GetInstance().get_Alliance().get_OwnedPOIs()),G.reverse(),G)switch(G[A].t){case 2:q.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}));break;case 3:y.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}));break;case 4:f.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}));break;case 5:m.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}));break;case 6:B.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}));break;case 7:I.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}));break;case 8:O.add(new qx.ui.basic.Label(G[A].l+' (<a style="cursor: pointer; color: #1d79ff" onclick="webfrontend.gui.UtilView.centerCoordinatesOnRegionViewWindow(parseInt('+G[A].x+"), parseInt("+G[A].y+'));">'+G[A].x+":"+G[A].y+"</a>)").set({rich:!0,alignX:"left"}))}G.reverse(),n.add(q),n.add(y),n.add(f),n.add(m),n.add(B),n.add(I),n.add(O),i.add(n),_.add(i),C.add(_),this.GuiPoisVBox.add(C),n=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),(i=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>POI-Level</b></u></big>").set({rich:!0})),i.add(new qx.ui.basic.Label("").set({rich:!0}));var _=(new qx.ui.container.Scroll).set({width:165,height:560}),C=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),S=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));S.add(new qx.ui.basic.Label("<b>Level</b>").set({rich:!0}));var P=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));P.add(new qx.ui.basic.Label("<b>Points</b>").set({rich:!0}));for(var v=ClientLib.Data.MainData.GetInstance().get_Server().get_MaxCenterLevel(),A=12;A<=v;A++){var j=ClientLib.Base.PointOfInterestTypes.GetScoreByLevel(A);S.add(new qx.ui.basic.Label(A.toLocaleString()).set({rich:!0,alignX:"right"})),P.add(new qx.ui.basic.Label(j.toLocaleString()).set({rich:!0,alignX:"right"}))}C.add(S),C.add(P),_.add(C),i.add(_),n.add(i),(C=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>POI-Tiers</b></u></big>").set({rich:!0})),C.add(new qx.ui.basic.Label("").set({rich:!0}));var _=(new qx.ui.container.Scroll).set({width:243,height:560}),i=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),V=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));V.add(new qx.ui.basic.Label("<b>Points</b>").set({rich:!0}));var X=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));X.add(new qx.ui.basic.Label("<b>Resources</b>").set({rich:!0}));var T=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));T.add(new qx.ui.basic.Label("<b>Fight</b>").set({rich:!0}));for(var k=ClientLib.Data.MainData.GetInstance().get_Server().get_POIGlobalBonusFactor(),M=[],R=-1,N=0,F=0,U=0;R!=N&&(R=N,N=ClientLib.Base.PointOfInterestTypes.GetNextScore(R),F=ClientLib.Base.PointOfInterestTypes.GetBoostsByScore(N,ClientLib.Data.Ranking.ERankingType.BonusTiberium,k),U=ClientLib.Base.PointOfInterestTypes.GetBoostsByScore(N,ClientLib.Data.Ranking.ERankingType.BonusInfantry,k),N!=R);)M.push(N),V.add(new qx.ui.basic.Label(N.toLocaleString()).set({rich:!0,alignX:"right"})),X.add(new qx.ui.basic.Label(F.toLocaleString()).set({rich:!0,alignX:"right"})),T.add(new qx.ui.basic.Label(U.toLocaleString()).set({rich:!0,alignX:"right"}));if(i.add(V),i.add(X),i.add(T),_.add(i),C.add(_),n.add(C),!this.ObjectData.server.SeasonServer){var H=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));H.add(new qx.ui.basic.Label("<big><u><b>Multiplier</b></u></big>").set({rich:!0})),H.add(new qx.ui.basic.Label("").set({rich:!0}));var E=(new qx.ui.container.Scroll).set({width:113,height:560}),Y=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),W=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));W.add(new qx.ui.basic.Label("<b>Rank</b>").set({rich:!0}));var z=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));for(z.add(new qx.ui.basic.Label("<b>Multiplier</b>").set({rich:!0})),A=1;A<=40;A++)j=ClientLib.Base.PointOfInterestTypes.GetBoostModifierByRank(A),W.add(new qx.ui.basic.Label(A.toLocaleString()).set({rich:!0,alignX:"right"})),z.add(new qx.ui.basic.Label(j.toLocaleString()).set({rich:!0,alignX:"right"}));Y.add(W),Y.add(z),E.add(Y),H.add(E),n.add(H)}this.GuiPoiDataVBox.add(n),C=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),(Y=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>Own Resources</b></u></big>").set({rich:!0})),Y.add(new qx.ui.basic.Label("").set({rich:!0})),E=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),(c=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b>BaseName</b>").set({rich:!0}));var Z=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));Z.add(new qx.ui.basic.Label("<b>Tiberium</b>").set({rich:!0}));var $=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));$.add(new qx.ui.basic.Label("<b>Crystal</b>").set({rich:!0}));var J=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));J.add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0}));var Q=0,K=0,ee=0;for(A in this.ObjectData.bases)c.add(new qx.ui.basic.Label(this.ObjectData.bases[A].BaseName).set({rich:!0,alignX:"left"})),Q+=se=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[this.ObjectData.bases[A].BaseId].GetResourceCount(ClientLib.Base.EResourceType.Tiberium)),K+=re=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[this.ObjectData.bases[A].BaseId].GetResourceCount(ClientLib.Base.EResourceType.Crystal)),ee+=oe=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[this.ObjectData.bases[A].BaseId].GetResourceCount(ClientLib.Base.EResourceType.Power)),Z.add(new qx.ui.basic.Label(se.toLocaleString()).set({rich:!0,alignX:"right"})),$.add(new qx.ui.basic.Label(re.toLocaleString()).set({rich:!0,alignX:"right"})),J.add(new qx.ui.basic.Label(oe.toLocaleString()).set({rich:!0,alignX:"right"}));c.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0})),Z.add(new qx.ui.basic.Label(Q.toLocaleString()).set({rich:!0,alignX:"right"})),$.add(new qx.ui.basic.Label(K.toLocaleString()).set({rich:!0,alignX:"right"})),J.add(new qx.ui.basic.Label(ee.toLocaleString()).set({rich:!0,alignX:"right"})),E.add(c),E.add(Z),E.add($),E.add(J),Y.add(E),C.add(Y),this.GuiResourcesVBox.add(C),C=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),(H=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>Resources through sell</b></u></big>").set({rich:!0})),n=new qx.ui.container.Composite(new qx.ui.layout.HBox(15).set({alignX:"center"})),(E=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("").set({rich:!0}));var Y=new qx.ui.container.Composite(new qx.ui.layout.HBox(5).set({alignX:"center"})),te=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));for(A in te.add(new qx.ui.basic.Label("<b>BaseName</b>").set({rich:!0})),this.ObjectData.bases)te.add(new qx.ui.basic.Label(this.ObjectData.bases[A].BaseName).set({rich:!0,alignX:"right"}));te.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0})),Y.add(te),E.add(Y),n.add(E),(E=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b><u>Buildings</u></b>").set({rich:!0}));var Y=new qx.ui.container.Composite(new qx.ui.layout.HBox(5).set({alignX:"center"})),ae=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));ae.add(new qx.ui.basic.Label("<b>Tiberium</b>").set({rich:!0}));var ie=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));for(A in ie.add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0})),ee=Q=0,this.ObjectData.bases)Q+=se=this.calculateValueOfBase(this.ObjectData.bases[A].BaseId)[0],ee+=oe=this.calculateValueOfBase(this.ObjectData.bases[A].BaseId)[1],ae.add(new qx.ui.basic.Label(se.toLocaleString()).set({rich:!0,alignX:"right"})),ie.add(new qx.ui.basic.Label(oe.toLocaleString()).set({rich:!0,alignX:"right"}));ae.add(new qx.ui.basic.Label(Q.toLocaleString()).set({rich:!0,alignX:"right"})),ie.add(new qx.ui.basic.Label(ee.toLocaleString()).set({rich:!0,alignX:"right"})),Y.add(ae),Y.add(ie),E.add(Y),n.add(E),(E=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b><u>Defense</u></b>").set({rich:!0})),Y=new qx.ui.container.Composite(new qx.ui.layout.HBox(5).set({alignX:"center"})),(ae=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b>Tiberium</b>").set({rich:!0}));var ne=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));ne.add(new qx.ui.basic.Label("<b>Crystal</b>").set({rich:!0})),(ie=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0}));var se,Q=0,K=0,ee=0;for(A in this.ObjectData.bases)Q+=se=this.calculateValueOfDefense(this.ObjectData.bases[A].BaseId)[0],K+=re=this.calculateValueOfDefense(this.ObjectData.bases[A].BaseId)[1],ee+=oe=this.calculateValueOfDefense(this.ObjectData.bases[A].BaseId)[2],ae.add(new qx.ui.basic.Label(se.toLocaleString()).set({rich:!0,alignX:"right"})),ne.add(new qx.ui.basic.Label(re.toLocaleString()).set({rich:!0,alignX:"right"})),ie.add(new qx.ui.basic.Label(oe.toLocaleString()).set({rich:!0,alignX:"right"}));ae.add(new qx.ui.basic.Label(Q.toLocaleString()).set({rich:!0,alignX:"right"})),ne.add(new qx.ui.basic.Label(K.toLocaleString()).set({rich:!0,alignX:"right"})),ie.add(new qx.ui.basic.Label(ee.toLocaleString()).set({rich:!0,alignX:"right"})),Y.add(ae),Y.add(ne),Y.add(ie),E.add(Y),n.add(E),(E=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b><u>Offense</u></b>").set({rich:!0})),Y=new qx.ui.container.Composite(new qx.ui.layout.HBox(5).set({alignX:"center"})),(ne=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b>Crystal</b>").set({rich:!0})),(ie=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0}));var re,oe,K=0,ee=0;for(A in this.ObjectData.bases)K+=re=this.calculateValueOfOffense(this.ObjectData.bases[A].BaseId)[0],ee+=oe=this.calculateValueOfOffense(this.ObjectData.bases[A].BaseId)[1],ne.add(new qx.ui.basic.Label(re.toLocaleString()).set({rich:!0,alignX:"right"})),ie.add(new qx.ui.basic.Label(oe.toLocaleString()).set({rich:!0,alignX:"right"}));ne.add(new qx.ui.basic.Label(K.toLocaleString()).set({rich:!0,alignX:"right"})),ie.add(new qx.ui.basic.Label(ee.toLocaleString()).set({rich:!0,alignX:"right"})),Y.add(ne),Y.add(ie),E.add(Y),n.add(E),H.add(n),C.add(H),this.GuiSellBasesVBox.add(C),n=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),(H=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>Sell special base</b></u></big>").set({rich:!0})),H.add(new qx.ui.basic.Label("").set({rich:!0}));var C=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),le=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),ce=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),ue=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),de=new qx.ui.form.SelectBox,be=this;for(A in de.addListener("changeSelection",function(e){le.removeAll(),le.add(new qx.ui.basic.Label("<b>BuildingName</b>").set({rich:!0})),ce.removeAll(),ce.add(new qx.ui.basic.Label("<b>Tiberium</b>").set({rich:!0})),ue.removeAll(),ue.add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0}));var t,a=be.selectSpecialBaseForSell(e.getData()[0].getModel());for(t in a)le.add(new qx.ui.basic.Label(t).set({rich:!0,alignX:"left"})),ce.add(new qx.ui.basic.Label(a[t][0].toLocaleString()).set({rich:!0,alignX:"right"})),ue.add(new qx.ui.basic.Label(a[t][1].toLocaleString()).set({rich:!0,alignX:"right"}))},this),this.ObjectData.bases)de.add(new qx.ui.form.ListItem(this.ObjectData.bases[A].BaseName.toLocaleString(),null,this.ObjectData.bases[A].BaseId));for(A in C.add(le),C.add(ce),C.add(ue),H.add(de),H.add(new qx.ui.basic.Label("").set({rich:!0})),H.add(C),n.add(H),this.GuiSellSpecialBaseVBox.add(n),C=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),(H=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>Upgrade special base</b></u></big>").set({rich:!0})),H.add(new qx.ui.basic.Label("").set({rich:!0})),n=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),le=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),ce=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),ue=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),de=new qx.ui.form.SelectBox,be=this,de.addListener("changeSelection",function(e){le.removeAll(),le.add(new qx.ui.basic.Label("<b>BuildingName</b>").set({rich:!0})),ce.removeAll(),ce.add(new qx.ui.basic.Label("<b>Tiberium</b>").set({rich:!0})),ue.removeAll(),ue.add(new qx.ui.basic.Label("<b>Power</b>").set({rich:!0}));var t,a=be.selectSpecialBaseForUpgrade(e.getData()[0].getModel());for(t in a)le.add(new qx.ui.basic.Label(t).set({rich:!0,alignX:"left"})),ce.add(new qx.ui.basic.Label(a[t][0].toLocaleString()).set({rich:!0,alignX:"right"})),ue.add(new qx.ui.basic.Label(a[t][1].toLocaleString()).set({rich:!0,alignX:"right"}))},this),this.ObjectData.bases)de.add(new qx.ui.form.ListItem(this.ObjectData.bases[A].BaseName.toLocaleString(),null,this.ObjectData.bases[A].BaseId));n.add(le),n.add(ce),n.add(ue),H.add(de),H.add(new qx.ui.basic.Label("").set({rich:!0})),H.add(n),C.add(H),this.GuiUpgradeSpecialBaseVBox.add(C)},createTabPlayer:function(){var e=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),t=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));t.add(new qx.ui.basic.Label("<big><u><b>Player</b></u></big>").set({rich:!0})),t.add(new qx.ui.basic.Label("").set({rich:!0}));var a=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),i=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"right"})),n=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"left"}));if(i.add(new qx.ui.basic.Label("<b>Name</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PlayerName).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Rank</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PlayerRank.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Creation Date</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(new Date(ClientLib.Data.MainData.GetInstance().get_Player().get_CreationDate()).toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>ScorePoints</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PlayerScorePoints.toLocaleString()).set({rich:!0})),1==this.ObjectData.server.SeasonServer&&(i.add(new qx.ui.basic.Label("<b>Event-Rank</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PlayerEventRank.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>LegacyPoints</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.LegacyPoints.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>VeteranPoints</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PlayerVeteranPoints.toLocaleString()).set({rich:!0}))),0<this.ObjectData.alliance.AllianceId&&(i.add(new qx.ui.basic.Label("<b>AllianceRole</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_MemberData().d[ClientLib.Data.MainData.GetInstance().get_Player().get_Id()].RoleName).set({rich:!0}))),null!=this.ObjectData.player.Shoot?(i.add(new qx.ui.basic.Label("<b>PvE</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PvE.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>PvP</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.PvP.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.player.Shoot.toLocaleString()).set({rich:!0}))):setTimeout(function(e){e.createTabPlayer()},1e3,this),a.add(i),a.add(n),t.add(a),t.add(new qx.ui.basic.Label("").set({rich:!0})),t.add(new qx.ui.basic.Label("").set({rich:!0})),this.ObjectDataNotSend.Endgames&&this.ObjectDataNotSend.Challenges&&(0<this.ObjectDataNotSend.Endgames.length||0<this.ObjectDataNotSend.Challenges.length)){if(a=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),0<this.ObjectDataNotSend.Endgames.length){for(var s={},r=0;r<this.ObjectDataNotSend.Endgames.length;r++)s[this.ObjectDataNotSend.Endgames[r].r]?s[this.ObjectDataNotSend.Endgames[r].r]+=1:s[this.ObjectDataNotSend.Endgames[r].r]=1;var o=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));o.add(new qx.ui.basic.Label("<big><u><b>Endgames</b></u></big>").set({rich:!0})),o.add(new qx.ui.basic.Label("").set({rich:!0}));var l=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),i=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"right"})),n=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"right"}));for(d in i.add(new qx.ui.basic.Label("<b>Rank</b>").set({rich:!0,alignX:"center"})),n.add(new qx.ui.basic.Label("<b>Count</b>").set({rich:!0,alignX:"center"})),s)i.add(new qx.ui.basic.Label(d.toLocaleString()).set({rich:!0})),n.add(new qx.ui.basic.Label(s[d].toLocaleString()).set({rich:!0}));i.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0,alignX:"center"})),n.add(new qx.ui.basic.Label("<b>"+this.ObjectDataNotSend.Endgames.length.toLocaleString()+"</b>").set({rich:!0})),l.add(i),l.add(n),o.add(l),o.add(new qx.ui.basic.Label("").set({rich:!0})),a.add(o)}if(0<this.ObjectDataNotSend.Challenges.length){for(var c={Player:{1:0,10:0,100:0},Alliance:{1:0,2:0,3:0}},r=0;r<this.ObjectDataNotSend.Challenges.length;r++)this.ObjectDataNotSend.Challenges[r].ia?c.Alliance[this.ObjectDataNotSend.Challenges[r].r]+=1:1==this.ObjectDataNotSend.Challenges[r].r?c.Player[1]+=1:this.ObjectDataNotSend.Challenges[r].r<=10?c.Player[10]+=1:this.ObjectDataNotSend.Challenges[r].r<=100&&(c.Player[100]+=1);(o=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label("<big><u><b>Challenges</b></u></big>").set({rich:!0})),o.add(new qx.ui.basic.Label("").set({rich:!0}));var u,l=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),i=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"left"})),n=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"right"}));for(u in i.add(new qx.ui.basic.Label("<b>Rank</b>").set({rich:!0,alignX:"center"})),n.add(new qx.ui.basic.Label("<b>Count</b>").set({rich:!0,alignX:"center"})),c)for(var d in c[u])i.add(new qx.ui.basic.Label((u+" Top "+d).toLocaleString()).set({rich:!0})),n.add(new qx.ui.basic.Label(c[u][d].toLocaleString()).set({rich:!0}));i.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0,alignX:"center"})),n.add(new qx.ui.basic.Label("<b>"+this.ObjectDataNotSend.Challenges.length.toLocaleString()+"</b>").set({rich:!0})),l.add(i),l.add(n),o.add(l),o.add(new qx.ui.basic.Label("").set({rich:!0})),a.add(o)}t.add(a)}e.add(t),this.GuiPlayerVBox.removeAll(),this.GuiPlayerVBox.add(e)},createTabAlliance:function(){var e=new qx.ui.container.Composite(new qx.ui.layout.HBox(50).set({alignX:"center"})),t=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));if(t.add(new qx.ui.basic.Label("<big><u><b>Alliance</b></u></big>").set({rich:!0})),t.add(new qx.ui.basic.Label("").set({rich:!0})),0<this.ObjectData.alliance.AllianceId){var a=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),i=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"right"})),n=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"left"}));i.add(new qx.ui.basic.Label("<b>Name</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.AllianceName).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Rank</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.AllianceRank.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>ScorePoints</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.AllianceTotalScore.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>AverageScore</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.AllianceAverageScore.toLocaleString()).set({rich:!0})),1==this.ObjectData.server.SeasonServer&&(i.add(new qx.ui.basic.Label("<b>VeteranPoints</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.AllianceVeteranPoints.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>VP/h</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.AllianceProdVetPoints.toLocaleString()).set({rich:!0}))),null!=this.ObjectData.alliance.Shoot?(i.add(new qx.ui.basic.Label("<b>PvE</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.PvE.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>PvP</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.PvP.toLocaleString()).set({rich:!0})),i.add(new qx.ui.basic.Label("<b>Overall</b>").set({rich:!0})),n.add(new qx.ui.basic.Label(this.ObjectData.alliance.Shoot.toLocaleString()).set({rich:!0}))):setTimeout(function(e){e.createTabAlliance()},1e3,this),a.add(i),a.add(n),t.add(a),t.add(new qx.ui.basic.Label("").set({rich:!0})),t.add(new qx.ui.basic.Label("<big><u><b>Bonus</b></u></big>").set({rich:!0})),t.add(new qx.ui.basic.Label("").set({rich:!0}));for(var s=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),r=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),o=null,l=null,c=null,u=null,i=null,n=null,a=null,d=[0],b=-1,g=0;b!=g&&(b=g,(g=ClientLib.Base.PointOfInterestTypes.GetNextScore(b))!=b);)d.push(g);var h=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIRankScore(),x=[["<b>POI-Class</b>","<b>Score</b>","<b>PrevScore</b>","<b>NextScore</b>","<b>DiffPrev</b>","<b>DiffNext</b>","<b>PDP</b>","<b>PNP</b>","<b>PS</b>","<b>NS</b>","<b>DPS</b>","<b>DNS</b>","<b>PP</b>","<b>NP</b>","<b>Bonus</b>","<b>Rank</b>"],["POI-Class","own POI-Score","POI-Score of previous bonus tier","POI-Score of next bonus tier","Difference between previos POI-Score and current POI-Score","Difference between current POI-Score and next POI-Score","POI-Level allowed to loose without loosing preview bonus tier","POI-Level needed to get next bonus tier","POI-Score of subsequent alliance","POI-Score of previous alliance","Difference of own POI-Score and POI-Score of subsequent alliance","Difference of own POI-Score and POI-Score of previous alliance","POI-Level allowed to loose without loosing current ranking","POI-Level needed to get the next better ranking","own Bonus","own Rank"]];r.add(new qx.ui.basic.Label(x[0][0]).set({rich:!0,toolTipText:x[1][0]})),r.add(o=new qx.ui.basic.Atom("Tiberium","webfrontend/ui/common/icn_res_tiberium.png").set({rich:!0})),o.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),r.add(l=new qx.ui.basic.Atom("Crystal","webfrontend/ui/common/icn_res_chrystal.png").set({rich:!0})),l.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),r.add(c=new qx.ui.basic.Atom("Power","webfrontend/ui/common/icn_res_power.png").set({rich:!0})),c.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),r.add(u=new qx.ui.basic.Atom("Infantry","FactionUI/icons/icon_arsnl_off_squad.png").set({rich:!0})),u.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),r.add(i=new qx.ui.basic.Atom("Vehicle","FactionUI/icons/icon_arsnl_off_vehicle.png").set({rich:!0})),i.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),r.add(n=new qx.ui.basic.Atom("Aircraft","FactionUI/icons/icon_arsnl_off_plane.png").set({rich:!0})),n.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),r.add(a=new qx.ui.basic.Atom("Defense","FactionUI/icons/icon_def_army_points.png").set({rich:!0})),a.getChildControl("icon").set({width:18,height:18,scale:!0,alignY:"middle"}),s.add(r);var D=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));D.add(new qx.ui.basic.Label(x[0][1]).set({rich:!0,height:17,toolTipText:x[1][1]}));var w=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));w.add(new qx.ui.basic.Label(x[0][2]).set({rich:!0,height:17,toolTipText:x[1][2]}));var p=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));p.add(new qx.ui.basic.Label(x[0][3]).set({rich:!0,height:17,toolTipText:x[1][3]}));var L=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));L.add(new qx.ui.basic.Label(x[0][4]).set({rich:!0,height:17,toolTipText:x[1][4]}));var C=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));C.add(new qx.ui.basic.Label(x[0][5]).set({rich:!0,height:17,toolTipText:x[1][5]}));var _=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));_.add(new qx.ui.basic.Label(x[0][6]).set({rich:!0,height:17,toolTipText:x[1][6]}));var q=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));q.add(new qx.ui.basic.Label(x[0][7]).set({rich:!0,height:17,toolTipText:x[1][7]}));var y=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));y.add(new qx.ui.basic.Label(x[0][8]).set({rich:!0,height:17,toolTipText:x[1][8]}));var f=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));f.add(new qx.ui.basic.Label(x[0][9]).set({rich:!0,height:17,toolTipText:x[1][9]}));var m=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));m.add(new qx.ui.basic.Label(x[0][10]).set({rich:!0,height:17,toolTipText:x[1][10]}));var B=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));B.add(new qx.ui.basic.Label(x[0][11]).set({rich:!0,height:17,toolTipText:x[1][11]}));var I=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));I.add(new qx.ui.basic.Label(x[0][12]).set({rich:!0,height:17,toolTipText:x[1][12]}));var O=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));O.add(new qx.ui.basic.Label(x[0][13]).set({rich:!0,height:17,toolTipText:x[1][13]})),(r=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}))).add(new qx.ui.basic.Label(x[0][14]).set({rich:!0,height:17,toolTipText:x[1][14]}));var G=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"}));G.add(new qx.ui.basic.Label(x[0][15]).set({rich:!0,height:17,toolTipText:x[1][15]}));for(var S=ClientLib.Data.MainData.GetInstance().get_Server().get_MaxCenterLevel(),P=[],v=12;v<=S;v++)P.push(ClientLib.Base.PointOfInterestTypes.GetScoreByLevel(v));for(v=0;v<h.length;v++){D.add(new qx.ui.basic.Label(h[v].s.toLocaleString()).set({rich:!0,alignX:"right",height:18}));for(var A=1;h[v].s>=d[A];)A++;for(var j=0;h[v].s-d[A-1]>P[j];)j++;j--;for(var V=0;d[A]-h[v].s>P[V];)V++;for(var X=0;h[v].s-h[v].ps>P[X];)X++;X--;for(var T=0;h[v].ns-h[v].s>P[T];)T++;w.add(new qx.ui.basic.Label(d[A-1].toLocaleString()).set({rich:!0,alignX:"right",height:18})),A<d.length?p.add(new qx.ui.basic.Label(d[A].toLocaleString()).set({rich:!0,alignX:"right",height:18})):p.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})),L.add(new qx.ui.basic.Label((h[v].s-d[A-1]).toLocaleString()).set({rich:!0,alignX:"right",height:18})),A<d.length?C.add(new qx.ui.basic.Label((d[A]-h[v].s).toLocaleString()).set({rich:!0,alignX:"right",height:18})):C.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})),j+12<S&&12<=j?_.add(new qx.ui.basic.Label((j+12).toLocaleString()).set({rich:!0,alignX:"right",height:18})):_.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})),V+12<=S&&A<d.length?q.add(new qx.ui.basic.Label((V+12).toLocaleString()).set({rich:!0,alignX:"right",height:18})):q.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})),y.add(new qx.ui.basic.Label(h[v].ps.toLocaleString()).set({rich:!0,alignX:"right",height:18})),m.add(new qx.ui.basic.Label((h[v].s-h[v].ps).toLocaleString()).set({rich:!0,alignX:"right",height:18})),X+12<S&&12<=X+12?I.add(new qx.ui.basic.Label((X+12).toLocaleString()).set({rich:!0,alignX:"right",height:18})):X+12<S&&11<=X+12?I.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})):I.add(new qx.ui.basic.Label(S.toLocaleString()).set({rich:!0,alignX:"right",height:18})),1<h[v].r?(f.add(new qx.ui.basic.Label(h[v].ns.toLocaleString()).set({rich:!0,alignX:"right",height:18})),B.add(new qx.ui.basic.Label((h[v].ns-h[v].s).toLocaleString()).set({rich:!0,alignX:"right",height:18})),T+12<S?O.add(new qx.ui.basic.Label((T+12).toLocaleString()).set({rich:!0,alignX:"right",height:18})):O.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18}))):(f.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})),B.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18})),O.add(new qx.ui.basic.Label("n.a.").set({rich:!0,alignX:"right",height:18}))),G.add(new qx.ui.basic.Label(h[v].r).set({rich:!0,alignX:"right",height:18}))}r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POITiberiumBonus().toLocaleString()).set({rich:!0,alignX:"right",height:18})),r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POICrystalBonus().toLocaleString()).set({rich:!0,alignX:"right",height:18})),r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIPowerBonus().toLocaleString()).set({rich:!0,alignX:"right",height:18})),r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIInfantryBonus().toLocaleString()+" %").set({rich:!0,alignX:"right",height:18})),r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIVehicleBonus().toLocaleString()+" %").set({rich:!0,alignX:"right",height:18})),r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIAirBonus().toLocaleString()+" %").set({rich:!0,alignX:"right",height:18})),r.add(new qx.ui.basic.Label(ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIDefenseBonus().toLocaleString()+" %").set({rich:!0,alignX:"right",height:18})),s.add(D),s.add(w),s.add(p),s.add(L),s.add(C),s.add(_),s.add(q),s.add(y),s.add(f),s.add(m),s.add(B),s.add(I),s.add(O),s.add(r),s.add(G),t.add(s),t.add(new qx.ui.basic.Label("").set({rich:!0})),t.add(new qx.ui.basic.Label("<big><u><b>Description</b></u></big>").set({rich:!0})),t.add(new qx.ui.basic.Label("").set({rich:!0})),r=(new qx.ui.container.Scroll).set({height:180}),this.ObjectData.server.SeasonServer&&(r=(new qx.ui.container.Scroll).set({height:146}));for(var s=new qx.ui.container.Composite(new qx.ui.layout.HBox(10).set({alignX:"center"})),k=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),M=new qx.ui.container.Composite(new qx.ui.layout.VBox(1).set({alignX:"center"})),v=0;v<x[0].length;v++)k.add(new qx.ui.basic.Label(x[0][v]).set({rich:!0,alignX:"right"})),M.add(new qx.ui.basic.Label(x[1][v]).set({rich:!0,alignX:"left"}));s.add(k),s.add(M),r.add(s),t.add(r)}else t.add(new qx.ui.basic.Label("You are in no alliance...").set({rich:!0}));e.add(t),this.GuiAllianceVBox.removeAll(),this.GuiAllianceVBox.add(e)},selectSpecialBaseForSell:function(e){var t,a=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d,i={};for(t in a){var n,s=a[t].get_TechGameData_Obj().dn;"Construction Yard"!=s&&(n=this.calculateSellValueOfBuilding(e,t),i[s]||(i[s]=[0,0]),i[s][0]+=n[0],i[s][1]+=n[1])}return i},selectSpecialBaseForUpgrade:function(e){var t,a=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d,i={};for(t in a){var n=a[t].get_TechGameData_Obj().dn,s=this.calculateUpgradeValueOfBuilding(e,t);i[n]||(i[n]=[0,0]),i[n][0]+=s[0],i[n][1]+=s[1]}return i},calculateValueOfBase:function(e){var t,a,i=0,n=0,s=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d;for(t in s)"Construction Yard"!=s[t].get_TechGameData_Obj().dn&&(i+=(a=this.calculateSellValueOfBuilding(e,t))[0],n+=a[1]);return[i,n]},calculateSellValueOfBuilding:function(e,t){for(var a=ClientLib.Data.MainData.GetInstance().get_Server().get_CityMinLevelBuilding(),i=ClientLib.Data.MainData.GetInstance().get_Server().get_TechLevelUpgradeFactorResource(),n=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_CurrentLevel(),s=0,r=0,o=1;o<=n&&(null!=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[0]&&(s+=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[0].c),null!=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[1]&&(r+=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[1].c),12!=o);o++);for(o=13;o<=n;o++)s+=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[12].rr[0].c*Math.pow(i,o-12)),r+=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[12].rr[1].c*Math.pow(i,o-12));if(0<a){for(o=1;o<=a&&(null!=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[0]&&(s-=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[0].c),null!=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[1]&&(r-=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[o].rr[1].c),12!=o);o++);for(o=13;o<=a;o++)s-=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[12].rr[0].c*Math.pow(i,o-12)),r-=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[12].rr[1].c*Math.pow(i,o-12))}var l=ClientLib.Data.MainData.GetInstance().get_Server().get_BuildingRefundPercent();return[parseInt(l*s),parseInt(l*r)]},calculateUpgradeValueOfBuilding:function(e,t){var a=ClientLib.Data.MainData.GetInstance().get_Server().get_TechLevelUpgradeFactorResource(),i=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_CurrentLevel(),n=0,s=0,s=i<=11?(n=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[i+1].rr[0].c,ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[i+1].rr[1].c):(n=parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[12].rr[0].c*Math.pow(a,i+1-12)),parseInt(ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_Buildings().d[t].get_TechGameData_Obj().r[12].rr[1].c*Math.pow(a,i+1-12)));return[n,s]},calculateValueOfDefense:function(e){var t,a=0,i=0,n=0,e=ClientLib.Data.MainData.GetInstance().get_Cities().GetCity(e),s=this.getDefenseUnits(e);for(t in s){var r,o,l=s[t],c=l.get_CurrentLevel();for(r in l)"object"==typeof l[r]&&l[r]&&"i"in l[r]&&(o=l[r],a+=(o=this.calculateValueUnitDefense(o,c))[0],i+=o[1],n+=o[2])}return[a,i,n]},calculateValueOfOffense:function(e){var t,a=0,i=0,e=ClientLib.Data.MainData.GetInstance().get_Cities().GetCity(e),n=this.getOffenseUnits(e);for(t in n){var s,r,o=n[t],l=o.get_CurrentLevel();for(s in o)"object"==typeof o[s]&&o[s]&&"i"in o[s]&&(r=o[s],a+=(r=this.calculateValueUnitOffense(r,l))[0],i+=r[1])}return[a,i]},calculateValueUnitDefense:function(e,t){for(var a=ClientLib.Data.MainData.GetInstance().get_Server().get_CityMinLevelDefense(),i=ClientLib.Data.MainData.GetInstance().get_Server().get_UnitLevelUpgradeFactorResource(),n=0,s=0,r=0,o=1;o<=t;o++){if(null!=e.r[o].rr[0])switch(e.r[o].rr[0].t){case 1:n+=e.r[o].rr[0].c;break;case 2:s+=e.r[o].rr[0].c}if(null!=e.r[o].rr[1]&&(r+=e.r[o].rr[1].c),12==o)break}for(o=13;o<=t;o++)n?n+=parseInt(e.r[12].rr[0].c*Math.pow(i,o-12)):s&&(s+=parseInt(e.r[12].rr[0].c*Math.pow(i,o-12))),r+=parseInt(e.r[12].rr[1].c*Math.pow(i,o-12));if(0<a){for(o=1;o<=a;o++){if(null!=e.r[o].rr[0])switch(e.r[o].rr[0].t){case 1:n+=e.r[o].rr[0].c;break;case 2:s+=e.r[o].rr[0].c}if(null!=e.r[o].rr[1]&&(r-=e.r[o].rr[1].c),12==o)break}for(o=13;o<=a;o++)n?n-=parseInt(e.r[12].rr[0].c*Math.pow(i,o-12)):s&&(s-=parseInt(e.r[12].rr[0].c*Math.pow(i,o-12))),r-=parseInt(e.r[12].rr[1].c*Math.pow(i,o-12))}var l=ClientLib.Data.MainData.GetInstance().get_Server().get_UnitRefundPercent();return[parseInt(l*n),parseInt(l*s),parseInt(l*r)]},calculateValueUnitOffense:function(e,t){for(var a=ClientLib.Data.MainData.GetInstance().get_Server().get_CityMinLevelOffense(),i=ClientLib.Data.MainData.GetInstance().get_Server().get_UnitLevelUpgradeFactorResource(),n=0,s=0,r=1;r<=t&&(null!=e.r[r].rr[0]&&(n+=e.r[r].rr[0].c),null!=e.r[r].rr[1]&&(s+=e.r[r].rr[1].c),12!=r);r++);for(r=13;r<=t;r++)n+=parseInt(e.r[12].rr[0].c*Math.pow(i,r-12)),s+=parseInt(e.r[12].rr[1].c*Math.pow(i,r-12));if(0<a){for(r=1;r<=a&&(null!=e.r[r].rr[0]&&(n-=e.r[r].rr[0].c),null!=e.r[r].rr[1]&&(s-=e.r[r].rr[1].c),12!=r);r++);for(r=13;r<=a;r++)n-=parseInt(e.r[12].rr[0].c*Math.pow(i,r-12)),s-=parseInt(e.r[12].rr[1].c*Math.pow(i,r-12))}var o=ClientLib.Data.MainData.GetInstance().get_Server().get_UnitRefundPercent();return[parseInt(o*n),parseInt(o*s)]},setCncOptVars:function(){this.Defense_unit_map={GDI_Wall:"w",GDI_Cannon:"c","GDI_Antitank Barrier":"t",GDI_Barbwire:"b",GDI_Turret:"m",GDI_Flak:"f","GDI_Art Inf":"r","GDI_Art Air":"e","GDI_Art Tank":"a","GDI_Def_APC Guardian":"g","GDI_Def_Missile Squad":"q",GDI_Def_Pitbull:"p",GDI_Def_Predator:"d",GDI_Def_Sniper:"s","GDI_Def_Zone Trooper":"z","NOD_Def_Antitank Barrier":"t","NOD_Def_Art Air":"e","NOD_Def_Art Inf":"r","NOD_Def_Art Tank":"a","NOD_Def_Attack Bike":"p",NOD_Def_Barbwire:"b","NOD_Def_Black Hand":"z",NOD_Def_Cannon:"c",NOD_Def_Confessor:"s",NOD_Def_Flak:"f","NOD_Def_MG Nest":"m","NOD_Def_Militant Rocket Soldiers":"q",NOD_Def_Reckoner:"g","NOD_Def_Scorpion Tank":"d",NOD_Def_Wall:"w","":""},this.offense_unit_map={"GDI_APC Guardian":"g",GDI_Commando:"c",GDI_Firehawk:"f",GDI_Juggernaut:"j",GDI_Kodiak:"k",GDI_Mammoth:"m","GDI_Missile Squad":"q",GDI_Orca:"o",GDI_Paladin:"a",GDI_Pitbull:"p",GDI_Predator:"d",GDI_Riflemen:"r","GDI_Sniper Team":"s","GDI_Zone Trooper":"z","NOD_Attack Bike":"b",NOD_Avatar:"a","NOD_Black Hand":"z",NOD_Cobra:"r",NOD_Commando:"c",NOD_Confessor:"s","NOD_Militant Rocket Soldiers":"q",NOD_Militants:"m",NOD_Reckoner:"k",NOD_Salamander:"l","NOD_Scorpion Tank":"o","NOD_Specter Artilery":"p",NOD_Venom:"v",NOD_Vertigo:"t","":""}},findTechLayout:function(e){for(var t in e)if("object"==typeof e[t]&&e[t]&&0 in e[t]&&8 in e[t]&&"object"==typeof e[t][0]&&e[t][0]&&e[t][0]&&0 in e[t][0]&&15 in e[t][0]&&"object"==typeof e[t][0][0]&&e[t][0][0]&&"BuildingIndex"in e[t][0][0])return e[t];return null},findBuildings:function(e){var t,a=e.get_CityBuildingsData();for(t in a)if(376877<=PerforceChangelist){if("object"==typeof a[t]&&a[t]&&"d"in a[t]&&"c"in a[t]&&0<a[t].c)return a[t].d}else if("object"==typeof a[t]&&a[t]&&"l"in a[t])return a[t].l},isOffenseUnit:function(e){return e.get_UnitGameData_Obj().n in this.offense_unit_map},isDefenseUnit:function(e){return e.get_UnitGameData_Obj().n in this.Defense_unit_map},getUnitArrays:function(e){var t,a,i=[];for(t in e)if("object"==typeof e[t]&&e[t])for(var n in e[t])if(376877<=PerforceChangelist){if("object"==typeof e[t][n]&&e[t][n]&&"d"in e[t][n]&&"object"==typeof(a=e[t][n].d)&&a)for(var s in a)"object"==typeof a[s]&&a[s]&&"get_CurrentLevel"in a[s]&&i.push(a)}else if("object"==typeof e[t][n]&&e[t][n]&&"l"in e[t][n]&&"object"==typeof(a=e[t][n].l)&&a)for(var s in a)"object"==typeof a[s]&&a[s]&&"get_CurrentLevel"in a[s]&&i.push(a);return i},getDefenseUnits:function(e){for(var t=this.getUnitArrays(e),a=0;a<t.length;++a)for(var i in t[a])if(this.isDefenseUnit(t[a][i]))return t[a];return[]},getOffenseUnits:function(e){for(var t=this.getUnitArrays(e),a=0;a<t.length;++a)for(var i in t[a])if(this.isOffenseUnit(t[a][i]))return t[a];return[]},CnCOpt:function(e,t,a){var f=this,m={keymap:{GDI_Accumulator:"a",GDI_Refinery:"r","GDI_Trade Center":"u",GDI_Silo:"s","GDI_Power Plant":"p","GDI_Construction Yard":"y",GDI_Airport:"d",GDI_Barracks:"b",GDI_Factory:"f","GDI_Defense HQ":"q","GDI_Defense Facility":"w","GDI_Command Center":"e",GDI_Support_Art:"z",GDI_Support_Air:"x",GDI_Support_Ion:"i",FOR_Silo:"s",FOR_Refinery:"r","FOR_Tiberium Booster":"b","FOR_Crystal Booster":"v","FOR_Trade Center":"u","FOR_Defense Facility":"w","FOR_Construction Yard":"y","FOR_EVENT_Construction Yard":"y",FOR_Harvester_Tiberium:"h","FOR_Defense HQ":"q",FOR_Harvester_Crystal:"n",NOD_Refinery:"r","NOD_Power Plant":"p",NOD_Harvester:"h","NOD_Construction Yard":"y",NOD_Airport:"d","NOD_Trade Center":"u","NOD_Defense HQ":"q",NOD_Barracks:"b",NOD_Silo:"s",NOD_Factory:"f",NOD_Harvester_Crystal:"n","NOD_Command Post":"e",NOD_Support_Art:"z",NOD_Support_Ion:"i",NOD_Accumulator:"a",NOD_Support_Air:"x","NOD_Defense Facility":"w",GDI_Wall:"w",GDI_Cannon:"c","GDI_Antitank Barrier":"t",GDI_Barbwire:"b",GDI_Turret:"m",GDI_Flak:"f","GDI_Art Inf":"r","GDI_Art Air":"e","GDI_Art Tank":"a","GDI_Def_APC Guardian":"g","GDI_Def_Missile Squad":"q",GDI_Def_Pitbull:"p",GDI_Def_Predator:"d",GDI_Def_Sniper:"s","GDI_Def_Zone Trooper":"z","NOD_Def_Antitank Barrier":"t","NOD_Def_Art Air":"e","NOD_Def_Art Inf":"r","NOD_Def_Art Tank":"a","NOD_Def_Attack Bike":"p",NOD_Def_Barbwire:"b","NOD_Def_Black Hand":"z",NOD_Def_Cannon:"c",NOD_Def_Confessor:"s",NOD_Def_Flak:"f","NOD_Def_MG Nest":"m","NOD_Def_Militant Rocket Soldiers":"q",NOD_Def_Reckoner:"g","NOD_Def_Scorpion Tank":"d",NOD_Def_Wall:"w","GDI_APC Guardian":"g",GDI_Commando:"c",GDI_Firehawk:"f",GDI_Juggernaut:"j",GDI_Kodiak:"k",GDI_Mammoth:"m","GDI_Missile Squad":"q",GDI_Orca:"o",GDI_Paladin:"a",GDI_Pitbull:"p",GDI_Predator:"d",GDI_Riflemen:"r","GDI_Sniper Team":"s","GDI_Zone Trooper":"z","NOD_Attack Bike":"b",NOD_Avatar:"a","NOD_Black Hand":"z",NOD_Cobra:"r",NOD_Commando:"c",NOD_Confessor:"s","NOD_Militant Rocket Soldiers":"q",NOD_Militants:"m",NOD_Reckoner:"k",NOD_Salamander:"l","NOD_Scorpion Tank":"o","NOD_Specter Artilery":"p",NOD_Venom:"v",NOD_Vertigo:"t","<last>":"."},make_sharelink:function(e,t,a){try{var i=ClientLib.Data.MainData.GetInstance().get_Cities().GetCity(e),n=ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentOwnCity(),s=ClientLib.Data.MainData.GetInstance().get_Alliance(),r=ClientLib.Data.MainData.GetInstance().get_Server(),o="http://cncopt.com/?map=3|";switch(a){case 1:o+="G|G|";break;case 2:o+="N|N|"}o+=t+"|";for(var l=[],c=0;c<20;++c){for(var u=[],d=0;d<9;++d)u.push(null);l.push(u)}var b=f.getDefenseUnits(i);if(376877<=PerforceChangelist)for(var c in b)l[(x=b[c]).get_CoordX()][x.get_CoordY()+8]=x;else for(c=0;c<b.length;++c)l[(x=b[c]).get_CoordX()][x.get_CoordY()+8]=x;for(var g,h=[],c=0;c<20;++c){for(u=[],d=0;d<9;++d)u.push(null);h.push(u)}if(g=1==i.get_CityFaction()||2==i.get_CityFaction()?f.getOffenseUnits(i):f.getOffenseUnits(n),376877<=PerforceChangelist)for(var c in g)h[(x=g[c]).get_CoordX()][x.get_CoordY()+16]=x;else for(var x,c=0;c<g.length;++c)h[(x=g[c]).get_CoordX()][x.get_CoordY()+16]=x;for(var D=f.findTechLayout(i),w=f.findBuildings(i),c=0;c<20;++c)for(d=0;d<9;++d){var p=16<c?null:D[d][c],L=0,C=null;p&&0<=p.BuildingIndex&&(L=(C=w[p.BuildingIndex]).get_CurrentLevel());var _=l[d][c];_&&(L=_.get_CurrentLevel());var q,y=h[d][c];switch(y&&(L=y.get_CurrentLevel()),1<L&&(o+=L),16<c?0:i.GetResourceType(d,c)){case 0:C?(q=C.get_MdbBuildingId(),GAMEDATA.Tech[q].n in m.keymap?o+=m.keymap[GAMEDATA.Tech[q].n]:(console.log("cncopt [5]: Unhandled building: "+q,C),o+=".")):_?_.get_UnitGameData_Obj().n in m.keymap?o+=m.keymap[_.get_UnitGameData_Obj().n]:(console.log("cncopt [5]: Unhandled unit: "+_.get_UnitGameData_Obj().n),o+="."):y?y.get_UnitGameData_Obj().n in m.keymap?o+=m.keymap[y.get_UnitGameData_Obj().n]:(console.log("cncopt [5]: Unhandled unit: "+y.get_UnitGameData_Obj().n),o+="."):o+=".";break;case 1:p.BuildingIndex<0?o+="c":o+="n";break;case 2:p.BuildingIndex<0?o+="t":o+="h";break;case 4:o+="j";break;case 5:o+="h";break;case 6:o+="l";break;case 7:o+="k";break;default:console.log("cncopt [4]: Unhandled resource type: "+i.GetResourceType(d,c)),o+="."}}s&&n.get_AllianceId()==i.get_AllianceId()&&(o+="|"+s.get_POITiberiumBonus(),o+="|"+s.get_POICrystalBonus(),o+="|"+s.get_POIPowerBonus(),o+="|"+s.get_POIInfantryBonus(),o+="|"+s.get_POIVehicleBonus(),o+="|"+s.get_POIAirBonus(),o+="|"+s.get_POIDefenseBonus()),1.2!=r.get_TechLevelUpgradeFactorBonusAmount()&&(o+="|newEconomy"),f.linkBase=o}catch(e){console.log("cncopt [1]: ",e)}}};m.make_sharelink(e,t,a)},getCurrentStats:function(){try{var e=ClientLib.Data.MainData.GetInstance().get_Player().get_Id();if(0<e){this.ObjectData.server={},this.ObjectData.alliance={},this.ObjectData.player={},this.ObjectData.bases=[],this.ObjectData.substitution={},this.ObjectData.substitution.incoming=[],this.ObjectData.substitution.outgoing="",this.ObjectData.substitution.active=[];var t=ClientLib.Data.MainData.GetInstance().get_Server().get_WorldId(),a=ClientLib.Data.MainData.GetInstance().get_Server().get_Name().trim(),i=ClientLib.Data.MainData.GetInstance().get_Server().get_IsSeasonServer(),n=ClientLib.Data.MainData.GetInstance().get_Alliance().get_Id();if(0<n){var s=ClientLib.Data.MainData.GetInstance().get_Alliance().get_Name(),r=ClientLib.Data.MainData.GetInstance().get_Alliance().get_Rank(),o=ClientLib.Data.MainData.GetInstance().get_Alliance().get_EventRank(),l=ClientLib.Data.MainData.GetInstance().get_Alliance().get_TotalScore(),c=ClientLib.Data.MainData.GetInstance().get_Alliance().get_AverageScore(),u=ClientLib.Data.MainData.GetInstance().get_Alliance().get_EventScore(),d=0;try{for(Ve=0;Ve<ClientLib.Data.MainData.GetInstance().get_Alliance().get_OwnShieldHubs().length;Ve++)d+=ClientLib.Data.MainData.GetInstance().get_Server().GetControlHubVeteranPointsProduction(ClientLib.Data.MainData.GetInstance().get_Alliance().get_OwnShieldHubs()[Ve].l)}catch(e){}var b=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POITiberiumBonus(),g=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POICrystalBonus(),h=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIPowerBonus(),x=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIInfantryBonus(),D=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIVehicleBonus(),w=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIAirBonus(),p=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIDefenseBonus(),L=ClientLib.Data.MainData.GetInstance().get_Alliance().get_POIRankScore(),C=L[0].r,_=L[1].r,q=L[2].r,y=L[3].r,f=L[4].r,m=L[5].r,B=L[6].r,I=L[0].s,O=L[1].s,G=L[2].s,S=L[3].s,P=L[4].s,v=L[5].s,A=L[6].s}var j,V=ClientLib.Data.MainData.GetInstance().get_Player().get_AccountId(),X=ClientLib.Data.MainData.GetInstance().get_Player().get_Name(),T=ClientLib.Data.MainData.GetInstance().get_Player().get_ScorePoints(),k=ClientLib.Data.MainData.GetInstance().get_Player().get_OverallRank(),M=ClientLib.Data.MainData.GetInstance().get_Player().get_EventRank(),R=ClientLib.Data.MainData.GetInstance().get_Player().get_EventScore(),N=ClientLib.Data.MainData.GetInstance().get_Player().get_ResearchPoints(),F=ClientLib.Data.MainData.GetInstance().get_Player().GetCreditsCount(),U=ClientLib.Data.MainData.GetInstance().get_Inventory().get_PlayerFunds(),H=ClientLib.Data.MainData.GetInstance().get_Player().get_LegacyPoints(),E=ClientLib.Data.MainData.GetInstance().get_Player().GetCommandPointMaxStorage(),Y=ClientLib.Data.MainData.GetInstance().get_Player().GetCommandPointCount(),W=ClientLib.Data.MainData.GetInstance().get_Player().get_Faction(),z=ClientLib.Data.MainData.GetInstance().get_Alliance().get_CurrentMemberRoleInfo().SortOrder,Z=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d,J=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().c,Q=0,K=0,ee=0,te=0,ae=0,ie=0,ne=0,se=0,re=0,oe=0,le=0,ce=0,ue=0,de=0;for(j in Z){var be=Z[j],ge=be.get_Id(),he=be.get_Name(),xe=be.get_PosX(),De=be.get_PosY(),we=be.get_ConstructionYardLevel(),pe=be.get_LvlBase(),Le=be.get_LvlOffense(),Ce=be.get_LvlDefense();be.GetResourceMaxStorage(ClientLib.Base.EResourceType.RepairChargeInf)>de&&(de=be.GetResourceMaxStorage(ClientLib.Base.EResourceType.RepairChargeInf));var _e=be.GetResourceCount(ClientLib.Base.EResourceType.RepairChargeInf),qe=0,ye=be.get_CityBuildingsData().GetUniqueBuildingByTechName(ClientLib.Base.ETechName.Defense_Facility);null!==ye&&(ne+=qe=ye.get_CurrentLevel()),Q+=we,K+=pe,ee+=Le,te+=Ce,ae<Le&&(ae=Le),ie<Ce&&(ie=Ce);var fe=0,me="";null!==be.get_SupportData()&&(fe=be.get_SupportData().get_Level(),me=be.get_SupportWeapon().n.replace(/NOD_SUPPORT_/gi,"").replace(/GDI_SUPPORT_/gi,"").replace(/FOR_SUPPORT_/gi,""),se+=be.get_SupportData().get_Level(),re++);var Be=Math.round(be.GetResourceGrowPerHour(ClientLib.Base.EResourceType.Tiberium,!0,!0)),Ie=Math.round(be.GetResourceGrowPerHour(ClientLib.Base.EResourceType.Crystal,!0,!0)),Oe=Math.round(be.GetResourceGrowPerHour(ClientLib.Base.EResourceType.Power,!0,!0)),ye=parseInt(ClientLib.Base.Resource.GetResourceGrowPerHour(be.get_CityCreditsProduction(),!1)+ClientLib.Base.Resource.GetResourceBonusGrowPerHour(be.get_CityCreditsProduction(),!1));oe+=Be,le+=Ie,ce+=Oe,ue+=ye,(be={}).BaseId=ge,be.BaseName=he,be.PosX=xe,be.PosY=De,be.LvLCY=we,be.LvLBase=pe,be.LvLOffense=Le,be.LvLDefense=Ce,be.LvLDF=qe,be.LvLSupport=fe,be.SupArt=me,be.TiberiumPerHour=Be,be.CrystalPerHour=Ie,be.PowerPerHour=Oe,be.CreditsPerHour=ye,be.CurrentRepairTime=_e,this.CnCOpt(ge,he,W),be.CnCOpt=this.linkBase,this.ObjectData.bases.push(be),this.linkBase=""}var Ge=Q/J,Se=K/J,Pe=ee/J,ve=te/J,Ae=ne/J,L=se/J;this.ObjectData.server.WorldId=t,this.ObjectData.server.ServerName=a,this.ObjectData.server.SeasonServer=i,0<(this.ObjectData.alliance.AllianceId=n)&&(this.ObjectData.alliance.AllianceName=s,this.ObjectData.alliance.AllianceRank=r,this.ObjectData.alliance.AllianceEventRank=o,this.ObjectData.alliance.AllianceTotalScore=l,this.ObjectData.alliance.AllianceAverageScore=c,this.ObjectData.alliance.AllianceVeteranPoints=u,this.ObjectData.alliance.AllianceProdVetPoints=d,this.ObjectData.alliance.BonusTiberium=b,this.ObjectData.alliance.BonusCrystal=g,this.ObjectData.alliance.BonusPower=h,this.ObjectData.alliance.BonusInfantrie=x,this.ObjectData.alliance.BonusVehicle=D,this.ObjectData.alliance.BonusAir=w,this.ObjectData.alliance.BonusDef=p,this.ObjectData.alliance.RankTib=C,this.ObjectData.alliance.RankCry=_,this.ObjectData.alliance.RankPow=q,this.ObjectData.alliance.RankInf=y,this.ObjectData.alliance.RankVeh=f,this.ObjectData.alliance.RankAir=m,this.ObjectData.alliance.RankDef=B,this.ObjectData.alliance.ScoreTib=I,this.ObjectData.alliance.ScoreCry=O,this.ObjectData.alliance.ScorePow=G,this.ObjectData.alliance.ScoreInf=S,this.ObjectData.alliance.ScoreVeh=P,this.ObjectData.alliance.ScoreAir=v,this.ObjectData.alliance.ScoreDef=A),this.ObjectData.player.AccountId=V,this.ObjectData.player.PlayerName=X,this.ObjectData.player.PlayerScorePoints=T,this.ObjectData.player.CountBases=J,this.ObjectData.player.CountSup=re,this.ObjectData.player.PlayerRank=k,this.ObjectData.player.PlayerEventRank=M,this.ObjectData.player.PlayerVeteranPoints=R,this.ObjectData.player.ResearchPoints=N,this.ObjectData.player.Credits=F,this.ObjectData.player.Funds=U,this.ObjectData.player.LegacyPoints=H,this.ObjectData.player.CommandPointsMaxStorage=E,this.ObjectData.player.CommandPointsCurrent=Y,this.ObjectData.player.Faction=W,this.ObjectData.player.MemberRole=z,this.ObjectData.player.LvLHighestOff=ae,this.ObjectData.player.LvLHighestDef=ie,this.ObjectData.player.AverageCY=Ge,this.ObjectData.player.AverageBase=Se,this.ObjectData.player.AverageOff=Pe,this.ObjectData.player.AverageDef=ve,this.ObjectData.player.AverageDF=Ae,this.ObjectData.player.AverageSup=L,this.ObjectData.player.ProductionTiberium=oe,this.ObjectData.player.ProductionCrystal=le,this.ObjectData.player.ProductionPower=ce,this.ObjectData.player.ProductionCredits=ue,this.ObjectData.player.MaxRepairTime=de,ClientLib.Data.MainData.GetInstance().get_PlayerSubstitution().getOutgoing()&&(this.ObjectData.substitution.outgoing=ClientLib.Data.MainData.GetInstance().get_PlayerSubstitution().getOutgoing().n);for(var je=ClientLib.Data.MainData.GetInstance().get_PlayerSubstitution().getIncoming(),Ve=0;Ve<je.length;Ve++)this.ObjectData.substitution.incoming.push(je[Ve].n);for(var Xe,Te=ClientLib.Data.MainData.GetInstance().get_PlayerSubstitution().getSubstitution(),Ve=0;Ve<Te.length;Ve++)this.ObjectData.substitution.active.push(Te[Ve].n);ClientLib.Net.CommunicationManager.GetInstance().SendSimpleCommand("GetPublicPlayerInfo",{id:e},phe.cnc.Util.createEventDelegate(ClientLib.Net.CommandResult,this,this.getPublicPlayerInfo),null),0<n&&ClientLib.Net.CommunicationManager.GetInstance().SendSimpleCommand("GetPublicAllianceInfo",{id:n},phe.cnc.Util.createEventDelegate(ClientLib.Net.CommandResult,this,this.getPublicAllianceInfo),null),this.sendDataFromInGame(),this.ReportsAreLoading||(this.ReportsAreLoading=!0,V={action:"getExistingReportIds",WorldId:t,AccountId:V},Xe=this,$.post(ke+"php/manageBackend.php",V).always(function(e){for(var t=0;t<e.length;t++)Xe.ObjectReportData[e[t].ReportId]=e[t].ReportId;Xe.killReportTimeouts()})),setTimeout(function(e){e.getCurrentStats()},36e5,this)}else setTimeout(function(e){e.getCurrentStats()},1e3,this)}catch(e){console.log(e)}},getPublicPlayerInfo:function(e,t){for(var a=t.c,i=0;i<a.length;i++)this.ObjectData.bases[i].BasePoints=a[i].p;this.ObjectData.player.Shoot=t.bd,this.ObjectData.player.PvP=t.bd-t.bde,this.ObjectData.player.PvE=t.bde,this.ObjectDataNotSend.Endgames=t.ew,this.ObjectDataNotSend.Challenges=t.cw},getPublicAllianceInfo:function(e,t){this.ObjectData.alliance.Shoot=t.bd,this.ObjectData.alliance.PvP=t.bdp,this.ObjectData.alliance.PvE=t.bde},killReportTimeouts:function(){this.timeoutArrayReportDataManager.push([]);for(var e=0;e<this.timeoutArrayReportDataManager.length;e++)for(var t=0;t<this.timeoutArrayReportDataManager[e].length;t++)clearTimeout(this.timeoutArrayReportDataManager[e][t]);this.getReportHeaderAllManager()},getReportHeaderAllManager:function(){ClientLib.Net.CommunicationManager.GetInstance().SendSimpleCommand("GetReportHeaderAll",{type:1,skip:0,take:1e3,sort:1,ascending:!1},phe.cnc.Util.createEventDelegate(ClientLib.Net.CommandResult,this,this.getReportHeaderAll),null)},getReportHeaderAll:function(e,t){for(var a=t,i=[],n=0;n<a.length;n++)null==this.ObjectReportData[a[n].i]&&i.push(a[n].i);for(n=0;n<i.length;n++)this.getReportDataManager(i[n],n);this.ReportsAreLoading=!1},getReportDataManager:function(t,e){this.timeoutArrayReportDataManager[this.timeoutArrayReportDataManager.length-1].push(setTimeout(function(e){ClientLib.Net.CommunicationManager.GetInstance().SendSimpleCommand("GetReportData",{playerReportId:t},phe.cnc.Util.createEventDelegate(ClientLib.Net.CommandResult,e,e.getReportData),null)},1e3*e,this))},getReportData:function(e,t){if(t.i){var a={};if(a.WorldId=this.ObjectData.server.WorldId,a.AccountId=this.ObjectData.player.AccountId,a.ReportId=t.i,a.OwnBaseId=t.d.abi,a.AttackTime=t.d.t,a.TargetLevel=t.d.dbl,a.TargetFaction=t.d.dpf,a.BattleStatus=t.d.cr,a.GainTib=0,a.GainCry=0,a.GainCre=0,a.GainRp=0,2==t.tp)for(var i=0;i<t.d.arr.length;i++)switch(t.d.arr[i].t){case 1:a.GainTib=parseInt(t.d.arr[i].a);break;case 2:a.GainCry=parseInt(t.d.arr[i].a);break;case 3:a.GainCre=parseInt(t.d.arr[i].a);break;case 6:a.GainRp=parseInt(t.d.arr[i].a)}else if(1==t.tp)for(i=0;i<t.d.arp.length;i++)switch(t.d.arp[i].t){case 1:a.GainTib=parseInt(t.d.arp[i].a);break;case 2:a.GainCry=parseInt(t.d.arp[i].a);break;case 3:a.GainCre=parseInt(t.d.arp[i].a);break;case 6:a.GainRp=parseInt(t.d.arp[i].a)}for(a.CostCry=0,i=a.CostRep=0;i<t.d.arca.length;i++)switch(t.d.arca[i].t){case 2:a.CostCry=parseInt(t.d.arca[i].a);break;case 8:a.CostRep=parseInt(t.d.arca[i].a)}for(i=0;i<t.d.arci.length;i++)switch(t.d.arci[i].t){case 2:a.CostCry=parseInt(t.d.arci[i].a);break;case 9:a.CostRep=parseInt(t.d.arci[i].a)}this.ObjectReportData[t.i]=a,this.sendReportData(t.i)}},sendReportData:function(e){e={action:"sendDataFromInGameReport",ObjectData:[this.ObjectReportData[e]],ScriptVersionLocal:ge},$.post(ke+"php/manageBackend.php",e)},sendChatInfo:function(e){var t="",t=0!=e[0]||ClientLib.Data.MainData.GetInstance().get_Player().get_IsSubstituted()?"/w "+this.ObjectData.player.PlayerName+" Hallo "+this.ObjectData.player.PlayerName+", um zu leoStats zu gelangen, klicke auf [url]"+ke+"[/url].":"/w "+this.ObjectData.player.PlayerName+" Hallo "+this.ObjectData.player.PlayerName+", um zu leoStats zu gelangen, klicke auf [url]"+ke+'[/url]. Dein Benutzername ist "'+this.ObjectData.player.PlayerName+'" und dein Standardpasswort: "'+this.ObjectData.player.PlayerName+"_"+this.ObjectData.player.AccountId+'"';qx.core.Init.getApplication().getChat().getChatWidget().send(t)},sendDataFromInGame:function(){var e,t;null==this.ObjectData||null==this.ObjectData.player||null==this.ObjectData.player.Shoot||null==this.ObjectData.alliance||0!=this.ObjectData.alliance.AllianceId&&null==this.ObjectData.alliance.Shoot?setTimeout(function(e){e.sendDataFromInGame()},1e3,this):(e={action:"sendDataFromInGame",ObjectData:this.ObjectData,ScriptVersionLocal:ge},t=this,$.post(ke+"php/manageBackend.php",e).always(function(e){t.sendChatInfoStatus&&(t.sendChatInfo(e),t.sendChatInfoStatus=!1)}))}}}),leoStats.getInstance().initialize(),qx.Class.define("BaseScanner",{type:"singleton",extend:qx.core.Object,construct:function(){console.log("create BaseScanner...")},members:{initialize:function(){this.app=qx.core.Init.getApplication(),this.ArrayLayouts=[],this.ArrayScannedIds=[],this.ArrayIdsForScan=[],this.ScriptIsRunning=!1,this.buildGUI(),this.autoScanByClickOnBase()},buildGUI:function(){this.GuiButtonBaseScanner=new qx.ui.form.Button("Start BaseScanner...").set({center:!0,rich:!0}),this.GuiButtonBaseScanner.addListener("click",function(){this.ScriptIsRunning?this.stopBaseScan():this.startBaseScan()},this),this.app.getDesktop().add(this.GuiButtonBaseScanner,{right:125,top:24})},autoScanByClickOnBase:function(){this.initializeDefaultValues(),phe.cnc.Util.attachNetEvent(ClientLib.Data.MainData.GetInstance().get_Cities(),"CurrentChange",ClientLib.Data.CurrentCityChange,this,this.scanClickedBase)},scanClickedBase:function(t,a){var e;this.ScriptIsRunning||ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCity()&&(4!=(e=ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCity().get_CityFaction())&&5!=e&&6!=e&&8!=e||-1!=this.ArrayScannedIds.indexOf(a)||-1!=this.ArrayIdsForScan.indexOf(a)?0==e&&this.errorRangeCounter<5?(this.errorRangeCounter++,timeoutScanClickedBase=setTimeout(function(e){e.scanClickedBase(t,a)},1e3,this)):("undefined"!=typeof timeoutScanClickedBase&&clearTimeout(timeoutScanClickedBase),this.errorRangeCounter=0):(this.errorRangeCounter=0,"undefined"!=typeof timeoutScanClickedBase&&clearTimeout(timeoutScanClickedBase),this.ArrayIdsForScan=[],this.ArrayIdsForScan.push(a),this.scanFirstLayout()))},startBaseScan:function(){this.ScriptIsRunning=!0;var e=this.ArrayLayouts.length+this.ArrayIdsForScan.length;this.GuiButtonBaseScanner.setLabel("Scan Base... ("+this.ArrayLayouts.length+" / "+e+")"),this.startScan()},stopBaseScan:function(){this.ScriptIsRunning=!1,this.GuiButtonBaseScanner.setLabel("Start BaseScanner..."),this.stopScan()},initializeDefaultValues:function(){this.attRange=ClientLib.Data.MainData.GetInstance().get_Server().get_MaxAttackDistance(),this.ArrayPrototypeGameObjectType2=[],this.ArrayPrototypeGameObjectType3=[],this.ArrayIdsForScan=[],this.errorExistsCounter=0,this.errorRangeCounter=0},getArrayPrototypeGameObject:function(){var e,t=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d,a=0,i=0,n=0,s=0;for(e in t){for(var r=t[e].get_X(),o=t[e].get_Y(),l=r-10;l<r+10;l++){for(var c=o-10;c<o+10;c++){var u=ClientLib.Data.MainData.GetInstance().get_World().GetObjectFromPosition(l,c);if(null!=u)if(2!=u.Type||a||i)if(3!=u.Type||n||s){if(a&&i&&n&&s)break}else n=l,s=c;else a=l,i=c}if(a&&i&&n&&s)break}if(a&&i&&n&&s)break}for(e in ClientLib.Data.MainData.GetInstance().get_World().GetObjectFromPosition(a,i))this.ArrayPrototypeGameObjectType2.push(e);for(e in ClientLib.Data.MainData.GetInstance().get_World().GetObjectFromPosition(n,s))this.ArrayPrototypeGameObjectType3.push(e)},returnLayoutOfCurBaseAndEvaluateIt:function(){for(var e=new Array(16).fill().map(e=>new Array(9).fill("")),t=ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCity(),a=0;a<16;a++)for(var i=0;i<9;i++)t.GetResourceType(i,a)&&(e[a][i]=t.GetResourceType(i,a));for(var n=t.get_X(),s=t.get_Y(),r=0,o=0,l=0,c=0,u=0,d=0,b=0,g=0,h=0,x=0,D=0,w=0,p=0,L=0,C=0,_=0,q=0,y=0,f=0,m=0,B=0,I=0,O=0,G=0,S=0,P=0,v=0,a=0;a<8;a++)for(i=0;i<9;i++)if(""==e[a][i]){var A=0,j=0,V=0,X=0;switch(0==i&&0==a?(1==e[a][i+1]?(j++,V++):2==e[a][i+1]?(A++,V++):X++,1==e[a+1][i+1]?(j++,V++):2==e[a+1][i+1]?(A++,V++):X++,1==e[a+1][i]?(j++,V++):2==e[a+1][i]?(A++,V++):X++):8==i&&0==a?(1==e[a][i-1]?(j++,V++):2==e[a][i-1]?(A++,V++):X++,1==e[a+1][i-1]?(j++,V++):2==e[a+1][i-1]?(A++,V++):X++,1==e[a+1][i]?(j++,V++):2==e[a+1][i]?(A++,V++):X++):0==a?(1==e[a][i-1]?(j++,V++):2==e[a][i-1]?(A++,V++):X++,1==e[a+1][i-1]?(j++,V++):2==e[a+1][i-1]?(A++,V++):X++,1==e[a+1][i]?(j++,V++):2==e[a+1][i]?(A++,V++):X++,1==e[a+1][i+1]?(j++,V++):2==e[a+1][i+1]?(A++,V++):X++,1==e[a][i+1]?(j++,V++):2==e[a][i+1]?(A++,V++):X++):0==i&&7==a?(1==e[a-1][i]?(j++,V++):2==e[a-1][i]?(A++,V++):X++,1==e[a-1][i+1]?(j++,V++):2==e[a-1][i+1]?(A++,V++):X++,1==e[a][i+1]?(j++,V++):2==e[a][i+1]?(A++,V++):X++):0==i?(1==e[a-1][i]?(j++,V++):2==e[a-1][i]?(A++,V++):X++,1==e[a-1][i+1]?(j++,V++):2==e[a-1][i+1]?(A++,V++):X++,1==e[a][i+1]?(j++,V++):2==e[a][i+1]?(A++,V++):X++,1==e[a+1][i+1]?(j++,V++):2==e[a+1][i+1]?(A++,V++):X++,1==e[a+1][i]?(j++,V++):2==e[a+1][i]?(A++,V++):X++):8==i&&7==a?(1==e[a][i-1]?(j++,V++):2==e[a][i-1]?(A++,V++):X++,1==e[a-1][i-1]?(j++,V++):2==e[a-1][i-1]?(A++,V++):X++,1==e[a-1][i]?(j++,V++):2==e[a-1][i]?(A++,V++):X++):7==a?(1==e[a][i-1]?(j++,V++):2==e[a][i-1]?(A++,V++):X++,1==e[a-1][i-1]?(j++,V++):2==e[a-1][i-1]?(A++,V++):X++,1==e[a-1][i]?(j++,V++):2==e[a-1][i]?(A++,V++):X++,1==e[a-1][i+1]?(j++,V++):2==e[a-1][i+1]?(A++,V++):X++,1==e[a][i+1]?(j++,V++):2==e[a][i+1]?(A++,V++):X++):8==i?(1==e[a-1][i]?(j++,V++):2==e[a-1][i]?(A++,V++):X++,1==e[a-1][i-1]?(j++,V++):2==e[a-1][i-1]?(A++,V++):X++,1==e[a][i-1]?(j++,V++):2==e[a][i-1]?(A++,V++):X++,1==e[a+1][i-1]?(j++,V++):2==e[a+1][i-1]?(A++,V++):X++,1==e[a+1][i]?(j++,V++):2==e[a+1][i]?(A++,V++):X++):(1==e[a-1][i]?(j++,V++):2==e[a-1][i]?(A++,V++):X++,1==e[a-1][i+1]?(j++,V++):2==e[a-1][i+1]?(A++,V++):X++,1==e[a][i+1]?(j++,V++):2==e[a][i+1]?(A++,V++):X++,1==e[a+1][i+1]?(j++,V++):2==e[a+1][i+1]?(A++,V++):X++,1==e[a+1][i]?(j++,V++):2==e[a+1][i]?(A++,V++):X++,1==e[a+1][i-1]?(j++,V++):2==e[a+1][i-1]?(A++,V++):X++,1==e[a][i-1]?(j++,V++):2==e[a][i-1]?(A++,V++):X++,1==e[a-1][i-1]?(j++,V++):2==e[a-1][i-1]?(A++,V++):X++),A){case 6:l++;break;case 5:c++;break;case 4:u++;break;case 3:d++;break;case 2:b++;break;case 1:g++}switch(j){case 6:h++;break;case 5:x++;break;case 4:D++;break;case 3:w++;break;case 2:p++;break;case 1:L++}switch(V){case 6:C++;break;case 5:_++;break;case 4:q++;break;case 3:y++;break;case 2:f++;break;case 1:m++}switch(X){case 8:B++;break;case 7:I++;break;case 6:O++;break;case 5:G++;break;case 4:S++;break;case 3:P++;break;case 2:v++}}else 2==e[a][i]?r++:1==e[a][i]&&o++;return{Zeit:Date.now(),PosX:n,PosY:s,FieldsTib:r,FieldsCry:o,Layout:JSON.stringify(e),EvaluatedFields:[l,c,u,d,b,g,h,x,D,w,p,L,C,_,q,y,f,m,B,I,O,G,S,P,v]}},scanFirstLayout:function(){for(var e in this.ArrayIdsForScan){var a=this.ArrayIdsForScan[e];this.ScriptIsRunning&&ClientLib.Data.MainData.GetInstance().get_Cities().set_CurrentCityId(a),setTimeout(function(e){var t;ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCity()?(ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCity().get_Buildings().c&&ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCity().get_OwnerId()<0?(e.errorExistsCounter=0,e.ArrayLayouts.push(e.returnLayoutOfCurBaseAndEvaluateIt()),e.ScriptIsRunning?e.ArrayScannedIds.push(a):e.ArrayScannedIds.push(ClientLib.Data.MainData.GetInstance().get_Cities().get_CurrentCityId()),e.ArrayIdsForScan.splice(0,1),console.log(e.ArrayLayouts.length+" / "+e.ArrayIdsForScan.length),t=e.ArrayLayouts.length+e.ArrayIdsForScan.length,e.ScriptIsRunning&&e.GuiButtonBaseScanner.setLabel("Scan Base... ("+e.ArrayLayouts.length+" / "+t+")"),e.sendDataOnlyFromLastLayout()):e.errorExistsCounter<5?(e.errorExistsCounter++,console.log("Layout not found ("+e.errorExistsCounter+")")):(console.log("Layout not found ("+e.errorExistsCounter+"), removing it from scan"),e.ArrayIdsForScan.splice(0,1),e.errorExistsCounter=0),e.scanFirstLayout()):e.errorExistsCounter<5?e.errorExistsCounter+=1:(console.log("Layout not found ("+e.errorExistsCounter+"), removing it from scan"),e.ArrayIdsForScan.splice(0,1),e.errorExistsCounter=0,e.scanFirstLayout())},1e3,this);break}this.ArrayIdsForScan.length||setTimeout(function(e){e.stopBaseScan()},1e3,this)},scanAroundOwnBase:function(e){for(var t=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_PosX(),a=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d[e].get_PosY(),i=parseInt(t-this.attRange);i<=parseInt(t+this.attRange);i++)for(var n,s,r=parseInt(a-this.attRange);r<=parseInt(a+this.attRange);r++)Math.sqrt(Math.pow(i-t,2)+Math.pow(r-a,2))<=this.attRange&&(n=ClientLib.Data.MainData.GetInstance().get_World().GetObjectFromPosition(i,r))&&(3==n.Type&&(0<n[this.ArrayPrototypeGameObjectType3[10]]||0<n[this.ArrayPrototypeGameObjectType3[11]])?(s=n[this.ArrayPrototypeGameObjectType3[12]],-1==this.ArrayIdsForScan.indexOf(s)&&-1==this.ArrayScannedIds.indexOf(s)&&this.ArrayIdsForScan.push(s)):2==n.Type&&(s=n[this.ArrayPrototypeGameObjectType2[12]],-1==this.ArrayIdsForScan.indexOf(s)&&-1==this.ArrayScannedIds.indexOf(s)&&this.ArrayIdsForScan.push(s)))},iterateThroughOwnBases:function(){var e,t=ClientLib.Data.MainData.GetInstance().get_Cities().get_AllCities().d;for(e in t){var a=t[e].get_Id();this.scanAroundOwnBase(a)}},sendDataOnlyFromLastLayout:function(){var e=ClientLib.Data.MainData.GetInstance().get_Server().get_WorldId(),t=ClientLib.Data.MainData.GetInstance().get_Player().get_AccountId(),t={action:"sendDataFromInGameBaseScanner",ObjectData:[this.ArrayLayouts[this.ArrayLayouts.length-1]],WorldId:e,AccountId:t,ScriptVersionLocal:ge};$.post(ke+"php/manageBackend.php",t)},stopScan:function(){console.log("Stop..."),this.initializeDefaultValues()},startScan:function(){console.log("Start..."),this.initializeDefaultValues(),this.getArrayPrototypeGameObject(),this.iterateThroughOwnBases(),this.scanFirstLayout()}}}),void BaseScanner.getInstance().initialize()}catch(e){void 0!==console?console.log(e):window.opera?opera.postError(e):GM_log(e)}var ke,ge;setTimeout(e,1e3)}()}var t;(t=document.createElement("script")).innerHTML="("+e.toString()+")();",t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)}();